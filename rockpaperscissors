from random import randint
from mango import *

class playGame :

    # import tallies from database up here

    # constructs game
    def __init__(self):
        print('welcome!')

    # performs game functionality
    def newGame(self):
        # get the user input here
        print('rock (1), paper (2), scissors (3) ...')
        userChoice = int(input())
        while userChoice != 1 and userChoice != 2 and userChoice != 3:
            print('rock (1), paper (2), scissors (3) ...')
            userChoice = int(input())
        print('... shoot!')

        # function to update the db with the user selection
        def updateDB():
            # dict to convert number to word
            nums = {
                1 : 'one',
                2 : 'two',
                3 : 'three'
            }
            choice = nums.get(userChoice)
            choice = (choice + ".count")
            newT = mango["tallies"].update_one(
                {"_id" : 1},
                {"$inc":
                   {choice: 1}
                }
            )
        
        updateDB()

        # compute random
        computer = randint(1,3)

        # nested method to make number / word conversion faster
        def num_to_word(int):
            if int == 1:
                return 'rock'
            elif int == 2:
                return 'paper'
            else:
                return 'scissors'

        print('the computer chose ' + num_to_word(computer))

        # calculate if player wins or not
        if (userChoice == computer):
            print('you tied!')
        elif (userChoice - computer) == (1 or -2):
            print('you won!')
        else:
            print('you lost!')

# initializing game

game = playGame()
print('do you want to play rock paper scissors? (y/n)')
while input() == 'y':  
   game.newGame()
   print('do you want to play again? (y/n)')
